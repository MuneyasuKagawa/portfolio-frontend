# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Technology Stack

This is a **Next.js 15** portfolio website built with:

- **React 19** with TypeScript
- **Tailwind CSS** with shadcn/ui components (40+ components)
- **Framer Motion** for animations
- **Jotai** for global state management with localStorage persistence
- **next-themes** for dark/light mode
- **Custom i18n system** with English/Japanese support
- **AWS S3 + CloudFront** deployment via Terraform

## Development Commands

```bash
# Start development server
npm run dev

# Build for production (static export to /out directory)
npm run build

# Start production server (after build)
npm run start

# Format code with Prettier (includes Tailwind CSS class sorting)
npm run format

# Lint code with ESLint
npm run lint

# Deploy to AWS (builds, uploads to S3, and invalidates CloudFront)
# Requires CLOUDFRONT_DISTRIBUTION_ID in .env
npm run deploy

# Invalidate CloudFront cache only
npm run disable-cache
```

## Architecture Overview

### App Router Structure

- Uses Next.js 15 App Router with TypeScript
- Server components by default, client components marked with "use client"
- Static export configuration for AWS S3 deployment (`output: "export"`)
- Root layout handles theme provider, Jotai provider, and global styles
- Dynamic imports with SSR disabled for client-only components

### Portfolio Mode System

The application features a unique **dual-mode portfolio** system:

- **Developer Mode**: Showcases frontend/fullstack development projects
- **Designer Mode**: Showcases UI/UX design work and case studies
- State managed via Jotai with `portfolioModeAtom`
- URL query parameter integration (`?want=developer|designer`)
- Smooth transitions between modes using Framer Motion

### Internationalization (i18n)

Custom internationalization system supporting English and Japanese:

- Translation files: `/locales/en.json` and `/locales/ja.json`
- Custom hook: `useTranslation()` with dot notation key access
- Language state managed via Jotai with `languageAtom`
- Client-side language persistence in localStorage

### Component Architecture

- **UI Components**: `/components/ui/` - shadcn/ui component library (40+ components including accordion, dialog, form, etc.)
- **Feature Components**: `/components/` - custom portfolio components
- **Mode-Specific Components**: Separate `/developer/` and `/designer/` subdirectories
- **State Management**: Jotai atoms in `/lib/atoms.ts` for portfolio mode, theme, and language
- **Custom Hooks**: `/lib/use-portfolio-mode.ts` and `/lib/use-translation.ts`
- **Theme System**: CSS variables with light/dark mode support via next-themes
- **Responsive Design**: Mobile-first approach with Tailwind breakpoints

### Key Directories

- `/app/` - Next.js App Router pages and layouts
  - `/app/projects/[slug]/` - Dynamic routes for project detail pages
- `/components/` - React components (Hero, About, Projects, Skills, Contact, Footer)
  - `project-detail.tsx` - Project case study page component
- `/components/ui/` - shadcn/ui component library (50+ components)
- `/lib/` - Utility functions and configurations
- `/terraform/` - Infrastructure as Code for AWS deployment
- `/public/` - Static assets (images, PDFs)
- `/out/` - Static export output (generated by build)

## Deployment Infrastructure

### AWS Architecture

- **S3 Bucket**: Static website hosting with public read access
- **CloudFront**: CDN distribution with custom domain support
- **Route53**: DNS management for custom domain
- **ACM**: SSL certificate management
- **Terraform**: Infrastructure as Code with modular structure

### Deployment Process

- `npm run deploy` builds the site and uploads to S3
- CloudFront cache invalidation ensures fresh content
- GitHub repository linked via terraform/modules/s3/main.tf

## Development Patterns

### Component Development

- Server components by default for better performance
- Client components only when interactivity is needed
- Consistent use of TypeScript interfaces for props
- shadcn/ui components for consistent design system

### Styling Approach

- Tailwind CSS with custom CSS variables for theming
- Dark/light mode support via next-themes
- Responsive design patterns using Tailwind breakpoints
- Framer Motion for smooth animations and transitions

### Code Organization

- Barrel exports from component directories
- TypeScript strict mode enabled
- ESLint and Prettier for code quality
- No formal testing setup (consider adding Vitest + React Testing Library)

## Configuration Files

- `next.config.mjs` - Next.js configuration with static export, unoptimized images, and experimental webpack features
- `tailwind.config.ts` - Tailwind with shadcn/ui theme variables and tailwindcss-animate plugin
- `tsconfig.json` - TypeScript configuration with strict mode and path aliases (@/\*)
- `terraform/` - AWS infrastructure definitions (main.tf, variables.tf, providers.tf)
- `.env` - Environment variables (CLOUDFRONT_DISTRIBUTION_ID for cache invalidation)

## Theme System

The site supports light/dark mode using:

- CSS custom properties defined in globals.css
- next-themes provider in root layout
- Tailwind dark: variants for styling
- Theme toggle component for user preference

## Project-Specific Patterns

### Static Export Considerations

- Build output goes to `/out` directory for S3 deployment
- Images are unoptimized (`unoptimized: true` in next.config.mjs)
- Dynamic routes work with `generateStaticParams` for build-time generation
- No server-side features (API routes, middleware, ISR)

### TypeScript Usage

- Strict mode enabled with all checks
- Path alias `@/*` maps to project root
- Consistent interface definitions for component props
- Type-safe project data structures in `/app/projects/[slug]/page.tsx`

### Build Configuration

- ESLint errors are ignored during build (`ignoreDuringBuilds: true`)
- TypeScript errors are ignored during build (`ignoreBuildErrors: true`)
- Note: These settings should be changed for production quality

### Recent Additions

- Project detail pages with case studies (`/projects/[slug]`)
- Enhanced project cards with "View Details" links
- Comprehensive project data structure supporting:
  - Overview (problem, purpose, goals, solution)
  - Features, challenges, and results
  - Technical details and learning outcomes
